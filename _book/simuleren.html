<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Simuleren | Stat1: statistische modellen</title>
  <meta name="description" content="Simuleren | Stat1: statistische modellen">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Simuleren | Stat1: statistische modellen" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Simuleren | Stat1: statistische modellen" />
  
  
  

<meta name="author" content="Mark Smits">


<meta name="date" content="2019-07-10">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="eenzijdig-en-tweezijdig-toetsen.html">
<link rel="next" href="normale-verdeling.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Voorwoord</a><ul>
<li class="chapter" data-level="" data-path="opzet.html"><a href="opzet.html"><i class="fa fa-check"></i>Opzet</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="werkcollege-1-statistische-vragen-bij-grafieken.html"><a href="werkcollege-1-statistische-vragen-bij-grafieken.html"><i class="fa fa-check"></i>Werkcollege 1: Statistische vragen bij grafieken</a><ul>
<li class="chapter" data-level="" data-path="soorten-grafieken.html"><a href="soorten-grafieken.html"><i class="fa fa-check"></i>Soorten grafieken</a></li>
<li class="chapter" data-level="" data-path="soorten-data.html"><a href="soorten-data.html"><i class="fa fa-check"></i>Soorten data</a></li>
<li class="chapter" data-level="" data-path="statistische-vragen.html"><a href="statistische-vragen.html"><i class="fa fa-check"></i>Statistische vragen</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="werkcollege-2-statistische-toetsen.html"><a href="werkcollege-2-statistische-toetsen.html"><i class="fa fa-check"></i>Werkcollege 2: Statistische toetsen</a><ul>
<li class="chapter" data-level="" data-path="hypotheses.html"><a href="hypotheses.html"><i class="fa fa-check"></i>Hypotheses</a></li>
<li class="chapter" data-level="" data-path="type-i-en-type-ii-fouten.html"><a href="type-i-en-type-ii-fouten.html"><i class="fa fa-check"></i>Type I en type II fouten</a></li>
<li class="chapter" data-level="" data-path="eenzijdig-en-tweezijdig-toetsen.html"><a href="eenzijdig-en-tweezijdig-toetsen.html"><i class="fa fa-check"></i>Eenzijdig en tweezijdig toetsen</a></li>
<li class="chapter" data-level="" data-path="simuleren.html"><a href="simuleren.html"><i class="fa fa-check"></i>Simuleren</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="normale-verdeling.html"><a href="normale-verdeling.html"><i class="fa fa-check"></i>Normale verdeling</a><ul>
<li class="chapter" data-level="" data-path="r-als-alternatief-voor-een-tabel.html"><a href="r-als-alternatief-voor-een-tabel.html"><i class="fa fa-check"></i>R als alternatief voor een tabel</a></li>
<li class="chapter" data-level="" data-path="hypotheses-toetsen.html"><a href="hypotheses-toetsen.html"><i class="fa fa-check"></i>Hypotheses toetsen</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="t-toets-voor-een-steekproef.html"><a href="t-toets-voor-een-steekproef.html"><i class="fa fa-check"></i>t-toets voor één steekproef</a><ul>
<li class="chapter" data-level="" data-path="geschatte-standaarddeviatie.html"><a href="geschatte-standaarddeviatie.html"><i class="fa fa-check"></i>Geschatte standaarddeviatie</a></li>
<li class="chapter" data-level="" data-path="z-toets.html"><a href="z-toets.html"><i class="fa fa-check"></i>Z-toets</a></li>
<li class="chapter" data-level="" data-path="t-verdeling.html"><a href="t-verdeling.html"><i class="fa fa-check"></i>t-verdeling</a></li>
<li class="chapter" data-level="" data-path="one-sample-t-test-in-r.html"><a href="one-sample-t-test-in-r.html"><i class="fa fa-check"></i>one-sample t-test in R</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="gepaarde-t-toets.html"><a href="gepaarde-t-toets.html"><i class="fa fa-check"></i>Gepaarde t-toets</a><ul>
<li class="chapter" data-level="" data-path="gepaarde-data.html"><a href="gepaarde-data.html"><i class="fa fa-check"></i>Gepaarde data</a></li>
<li class="chapter" data-level="" data-path="gepaarde-t-toets-1.html"><a href="gepaarde-t-toets-1.html"><i class="fa fa-check"></i>Gepaarde t-toets</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="onafhankelijke-t-toets.html"><a href="onafhankelijke-t-toets.html"><i class="fa fa-check"></i>Onafhankelijke t-toets:</a><ul>
<li class="chapter" data-level="" data-path="standaarddeviatie.html"><a href="standaarddeviatie.html"><i class="fa fa-check"></i>Standaarddeviatie</a></li>
<li class="chapter" data-level="" data-path="t-toets-in-r.html"><a href="t-toets-in-r.html"><i class="fa fa-check"></i>T-toets in R</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Stat1: statistische modellen</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="simuleren" class="section level2">
<h2>Simuleren</h2>
<p>De beste manier om begrip te krijgen van statistische toetsen, is om met data te simuleren. R is hier ideaal voor. Met de functie <code>sample()</code> kan je een random sample nemen uit een populatie:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">steekproef1 &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="st">&quot;links&quot;</span>, <span class="st">&quot;rechts&quot;</span>), <span class="dv">18</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>De functie <code>sample()</code> heeft in bovenstaand voorbeeld 3 <strong>argumenten</strong>. Het eerste argument is een <strong>vector</strong> met de mogelijke waarden in de populatie, het tweede argument geeft de grootte van de steekproef en het derde argument geeft aan dat er een oneindige populatie is met “links”- en“rechts”-waarden. De functie neemt aan dat “links” en “rechts” beiden evenveel voorkomen.</p>
<p>Met de table-functie kan je gemakkelijk checken hoeveel rechtshandige padden er in de steekproef zitten:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(steekproef1)</code></pre></div>

<div class="exercise">
<p><span id="exr:steekproef" class="exercise"><strong>Opdracht 6  </strong></span>Steekproef</p>
<ul>
<li>Gebruik bovenstaande code om een steekproef te nemen van 18 padden</li>
<li>Geef het aantal rechtshandige padden door aan de docent. Of via de volgende <a href="https://forms.office.com/Pages/ResponsePage.aspx?id=KiOfzFGYsEayPmQdaAWQ3wQeab5hX9VKmg2j17Cef29UMVUzWUNZT1RKVVNNVjlRSjRBMkNVNVVNWS4u" target="_blank">link</a>
</div>
</li>
</ul>
<p>Stel dat er wel een voorkeur voor rechtshandigheid is bij padden. Zeg dat 80% van de padden rechtshandig is.</p>
<p>Met een iets aangepaste code kunnen we weer een steekproef nemen, maar nu van deze populatie:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">steekproef2 &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="st">&quot;links&quot;</span>, <span class="st">&quot;rechts&quot;</span>), <span class="dv">18</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="fl">0.2</span>, <span class="fl">0.8</span>))</code></pre></div>

<div class="exercise">
<p><span id="exr:steekproef2" class="exercise"><strong>Opdracht 7  </strong></span>Steekproef2</p>
<ul>
<li>Neem nu een steekproef van de populatie padden met 80% rechtshandigheid.</li>
<li>Geef het aantal rechtshandige padden door aan de docent. Of via de link.
</div>
</li>
</ul>
<p>Je ziet dat het moeilijk is om de juiste conclusie te trekken uit een steekproef. Er zit altijd een mate van onzekerheid omheen.</p>
<p>De oplossing is om die onzekerheid goed te omschrijven. Met een statistische toets neem je de kansverdeling onder de nulhypothese als basis. In het geval van de padden gaan we onder de nulhypothese er van uit dat er geen verschil is tussen kans op links- of rechtshandigheid bij padden. Met R code kunnen we die kansverdeling berekenen en in een histogram weergeven:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)

<span class="co">#10000 steekproeven nemen, resultaat is een matrix</span>
samples &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">10000</span>, <span class="kw">sample</span>(<span class="kw">c</span>(<span class="st">&quot;links&quot;</span>, <span class="st">&quot;rechts&quot;</span>), <span class="dv">18</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>))
<span class="co">#Matrix omzetten naar een dataframe</span>
samples &lt;-<span class="st"> </span><span class="kw">data.frame</span>(samples) %&gt;%<span class="st"> </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;steekproef&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;voorkeur&quot;</span>)

<span class="co">#Aantal rechtshandigen per steekproef</span>
rechts &lt;-<span class="st"> </span>samples %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(voorkeur ==<span class="st"> &quot;rechts&quot;</span>) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(steekproef) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">count</span>()

<span class="co">#Histogram maken van het gevonden aantal rechtshandige padden per steekproef</span>
rechts %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(n)) +
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">center =</span> <span class="dv">0</span>, 
    <span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>) +
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;aantal rechtshandige padden&quot;</span>) +
<span class="st">  </span><span class="kw">theme_classic</span>()</code></pre></div>
<p>Met de volgende functie kan je de kans berekenen (onder de nulhypothese) op minstens het aantal rechtshandige padden, als in je eigen steekproef (als voorbeeld minstens 14):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Op basis van gesimuleerde kansverdeling</span>
<span class="kw">sum</span>(rechts$n&gt;=<span class="dv">14</span>)/<span class="kw">length</span>(rechts$n)

<span class="co">#Op basis van theoretische kansverdeling</span>
<span class="kw">binom.test</span>(<span class="dv">14</span>,<span class="dv">18</span>, <span class="dt">alternative =</span> <span class="st">&quot;greater&quot;</span>)</code></pre></div>

<div class="exercise">
<p><span id="exr:stattoets" class="exercise"><strong>Opdracht 8  </strong></span>Statistische toets</p>
<ul>
<li>Gebruik bovenstaande code om uit te rekenen wat de kans is op minstens zoveel rechtshandige padden als je gevonden hebt in je steekproef (doe dat voor beide steekproeven).</li>
<li>Stel de drempelwaarde van de kans op fout van de eerste soort op 0,05. Wat is dan je conclusie bij beide steekproeven. Geef dat door aan de docent. Of via de link.</li>
<li>Als iedereen het heeft uitgevoerd:
<ul>
<li>Hoeveel procent van de studenten verwerpt ten onrechte de nul-hypothese van de eerste steekproef (type I fout)?</li>
<li>Hoeveel procent van de studenten verwerpt niet de nulhypothese (type II fout)?
</div>
</li>
</ul></li>
</ul>

<div class="exercise">
<p><span id="exr:oefeningen_H6" class="exercise"><strong>(#exr:oefeningen_H6) </strong></span> * 6.1 * 6.2 * 6.3 * 6.7 * 6.8 * 6.10 * 6.12</p>
</div>
<p></p>

</div>
<!-- </div> -->
            </section>

          </div>
        </div>
      </div>
<a href="eenzijdig-en-tweezijdig-toetsen.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="normale-verdeling.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"collapse": "subsection"
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
